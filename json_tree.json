============================= test session starts ==============================
platform darwin -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0 -- /Users/agenticai/Library/CloudStorage/GoogleDrive-vijay.sankar.rajan@gmail.com/My Drive/ML and EDA solutions with sketches/Decision-trees_CART_sketch/venv/bin/python3.13
cachedir: .pytest_cache
rootdir: /Users/agenticai/Library/CloudStorage/GoogleDrive-vijay.sankar.rajan@gmail.com/My Drive/ML and EDA solutions with sketches/Decision-trees_CART_sketch
configfile: pytest.ini
plugins: cov-7.0.0
collecting ... collected 5 items

tests/integration/mushroom/test_mushroom_regression.py::TestMushroomRegression::test_core_criteria_regression[default_gini] Loading sketches from CSV files...
  Loaded positive sketches from: tests/fixtures/mushroom_positive_sketches_lg_k_11.csv
  Loaded negative sketches from: tests/fixtures/mushroom_negative_sketches_lg_k_11.csv

============================================================
CURRENT OUTPUT FOR DEFAULT_GINI:
============================================================
{
  "description": "Default Gini criterion, depth 5",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.4996,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.2841,
      "is_leaf": false,
      "type": "split",
      "feature_name": "stalk_root=c",
      "feature_idx": 99,
      "split_condition": "stalk_root=c == 1",
      "left_condition": "stalk_root=c == 1 (TRUE)",
      "right_condition": "stalk_root=c == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 4028.5370599430976,
        "class_counts": [
          295.63590238745047,
          3732.901157555647
        ],
        "impurity": 0.136,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_root=r",
        "feature_idx": 101,
        "split_condition": "stalk_root=r == 1",
        "left_condition": "stalk_root=r == 1 (TRUE)",
        "right_condition": "stalk_root=r == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3824.713549601439,
          "class_counts": [
            91.81239204579207,
            3732.901157555647
          ],
          "impurity": 0.0469,
          "is_leaf": false,
          "type": "split",
          "feature_name": "odor=l",
          "feature_idx": 50,
          "split_condition": "odor=l == 1",
          "left_condition": "odor=l == 1 (TRUE)",
          "right_condition": "odor=l == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 3773.2986100557955,
            "class_counts": [
              40.39745250014851,
              3732.901157555647
            ],
            "impurity": 0.0212,
            "is_leaf": false,
            "type": "split",
            "feature_name": "odor=a",
            "feature_idx": 47,
            "split_condition": "odor=a == 1",
            "left_condition": "odor=a == 1 (TRUE)",
            "right_condition": "odor=a == 0 (FALSE/NOT)",
            "left": {
              "depth": 5,
              "n_samples": 3732.901157555647,
              "class_counts": [
                0.0,
                3732.901157555647
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 1,
              "probabilities": [
                0.0,
                1.0
              ]
            },
            "right": {
              "depth": 5,
              "n_samples": 40.39745250014851,
              "class_counts": [
                40.39745250014851,
                0.0
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 0,
              "probabilities": [
                1.0,
                0.0
              ]
            }
          },
          "right": {
            "depth": 4,
            "n_samples": 51.41493954564356,
            "class_counts": [
              51.41493954564356,
              0.0
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 0,
            "probabilities": [
              1.0,
              0.0
            ]
          }
        },
        "right": {
          "depth": 3,
          "n_samples": 203.8235103416584,
          "class_counts": [
            203.8235103416584,
            0.0
          ],
          "impurity": 0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 524.0237736716213,
        "class_counts": [
          484.76943000178215,
          39.25434366983905
        ],
        "impurity": 0.1386,
        "is_leaf": false,
        "type": "split",
        "feature_name": "bruises=t",
        "feature_idx": 1,
        "split_condition": "bruises=t == 1",
        "left_condition": "bruises=t == 1 (TRUE)",
        "right_condition": "bruises=t == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 39.25434366983905,
          "class_counts": [
            0.0,
            39.25434366983905
          ],
          "impurity": 0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.0,
            1.0
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 484.76943000178215,
          "class_counts": [
            484.76943000178215,
            0.0
          ],
          "impurity": 0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      }
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.0686,
      "is_leaf": false,
      "type": "split",
      "feature_name": "spore_print_color=r",
      "feature_idx": 75,
      "split_condition": "spore_print_color=r == 1",
      "left_condition": "spore_print_color=r == 1 (TRUE)",
      "right_condition": "spore_print_color=r == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3396.113436581313,
        "class_counts": [
          3345.643566148663,
          50.46987043265021
        ],
        "impurity": 0.0293,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_surface_below_ring=y",
        "feature_idx": 111,
        "split_condition": "stalk_surface_below_ring=y == 1",
        "left_condition": "stalk_surface_below_ring=y == 1 (TRUE)",
        "right_condition": "stalk_surface_below_ring=y == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3343.939344785958,
          "class_counts": [
            3336.462326944084,
            7.477017841874106
          ],
          "impurity": 0.0045,
          "is_leaf": false,
          "type": "split",
          "feature_name": "cap_surface=g",
          "feature_idx": 19,
          "split_condition": "cap_surface=g == 1",
          "left_condition": "cap_surface=g == 1 (TRUE)",
          "right_condition": "cap_surface=g == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 3338.3315814045527,
            "class_counts": [
              3336.462326944084,
              1.8692544604685264
            ],
            "impurity": 0.0011,
            "is_leaf": false,
            "type": "split",
            "feature_name": "cap_shape=c",
            "feature_idx": 13,
            "split_condition": "cap_shape=c == 1",
            "left_condition": "cap_shape=c == 1 (TRUE)",
            "right_condition": "cap_shape=c == 0 (FALSE/NOT)",
            "left": {
              "depth": 5,
              "n_samples": 3336.462326944084,
              "class_counts": [
                3336.462326944084,
                0.0
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 0,
              "probabilities": [
                1.0,
                0.0
              ]
            },
            "right": {
              "depth": 5,
              "n_samples": 1.8692544604685264,
              "class_counts": [
                0.0,
                1.8692544604685264
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 1,
              "probabilities": [
                0.0,
                1.0
              ]
            }
          },
          "right": {
            "depth": 4,
            "n_samples": 5.6077633814055785,
            "class_counts": [
              0.0,
              5.6077633814055785
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 1,
            "probabilities": [
              0.0,
              1.0
            ]
          }
        },
        "right": {
          "depth": 3,
          "n_samples": 52.17409179535531,
          "class_counts": [
            9.181239204579207,
            42.9928525907761
          ],
          "impurity": 0.29,
          "is_leaf": false,
          "type": "split",
          "feature_name": "gill_size=n",
          "feature_idx": 37,
          "split_condition": "gill_size=n == 1",
          "left_condition": "gill_size=n == 1 (TRUE)",
          "right_condition": "gill_size=n == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 9.22462305734185,
            "class_counts": [
              9.22462305734185,
              0.0
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 0,
            "probabilities": [
              1.0,
              0.0
            ]
          },
          "right": {
            "depth": 4,
            "n_samples": 42.9928525907761,
            "class_counts": [
              0.0,
              42.9928525907761
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 1,
            "probabilities": [
              0.0,
              1.0
            ]
          }
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 72.90092395827253,
        "class_counts": [
          0.0,
          72.90092395827253
        ],
        "impurity": 0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      }
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0009323614920445829,
    0.0,
    0.0,
    0.0,
    0.002790830220784924,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.018123042261037198,
    0.0,
    0.0,
    0.019945202131617722,
    0.02477543957283661,
    0.6179087499052546,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0037757376824944047,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.16787276513871047,
    0.0,
    0.09199413250932215,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.017314615958776716,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.03456712312712062,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      0.6179087499052546
    ],
    [
      "stalk_root=c",
      0.16787276513871047
    ],
    [
      "stalk_root=r",
      0.09199413250932215
    ],
    [
      "spore_print_color=r",
      0.03456712312712062
    ],
    [
      "odor=l",
      0.02477543957283661
    ],
    [
      "odor=a",
      0.019945202131617722
    ],
    [
      "bruises=t",
      0.018123042261037198
    ],
    [
      "stalk_surface_below_ring=y",
      0.017314615958776716
    ],
    [
      "gill_size=n",
      0.0037757376824944047
    ],
    [
      "cap_surface=g",
      0.002790830220784924
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================

============================================================
BASELINE OUTPUT FOR DEFAULT_GINI:
============================================================
{
  "description": "Default Gini criterion, depth 5",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.4996,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.2841,
      "is_leaf": false,
      "type": "split",
      "feature_name": "stalk_root=c",
      "feature_idx": 99,
      "split_condition": "stalk_root=c == 1",
      "left_condition": "stalk_root=c == 1 (TRUE)",
      "right_condition": "stalk_root=c == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 4028.5370599430976,
        "class_counts": [
          295.63590238745047,
          3732.901157555647
        ],
        "impurity": 0.136,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_root=r",
        "feature_idx": 101,
        "split_condition": "stalk_root=r == 1",
        "left_condition": "stalk_root=r == 1 (TRUE)",
        "right_condition": "stalk_root=r == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3824.713549601439,
          "class_counts": [
            91.81239204579207,
            3732.901157555647
          ],
          "impurity": 0.0469,
          "is_leaf": false,
          "type": "split",
          "feature_name": "odor=l",
          "feature_idx": 50,
          "split_condition": "odor=l == 1",
          "left_condition": "odor=l == 1 (TRUE)",
          "right_condition": "odor=l == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 3773.2986100557955,
            "class_counts": [
              40.39745250014851,
              3732.901157555647
            ],
            "impurity": 0.0212,
            "is_leaf": false,
            "type": "split",
            "feature_name": "odor=a",
            "feature_idx": 47,
            "split_condition": "odor=a == 1",
            "left_condition": "odor=a == 1 (TRUE)",
            "right_condition": "odor=a == 0 (FALSE/NOT)",
            "left": {
              "depth": 5,
              "n_samples": 3732.901157555647,
              "class_counts": [
                0.0,
                3732.901157555647
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 1,
              "probabilities": [
                0.0,
                1.0
              ]
            },
            "right": {
              "depth": 5,
              "n_samples": 40.39745250014851,
              "class_counts": [
                40.39745250014851,
                0.0
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 0,
              "probabilities": [
                1.0,
                0.0
              ]
            }
          },
          "right": {
            "depth": 4,
            "n_samples": 51.41493954564356,
            "class_counts": [
              51.41493954564356,
              0.0
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 0,
            "probabilities": [
              1.0,
              0.0
            ]
          }
        },
        "right": {
          "depth": 3,
          "n_samples": 203.8235103416584,
          "class_counts": [
            203.8235103416584,
            0.0
          ],
          "impurity": 0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 524.0237736716213,
        "class_counts": [
          484.76943000178215,
          39.25434366983905
        ],
        "impurity": 0.1386,
        "is_leaf": false,
        "type": "split",
        "feature_name": "bruises=t",
        "feature_idx": 1,
        "split_condition": "bruises=t == 1",
        "left_condition": "bruises=t == 1 (TRUE)",
        "right_condition": "bruises=t == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 39.25434366983905,
          "class_counts": [
            0.0,
            39.25434366983905
          ],
          "impurity": 0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.0,
            1.0
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 484.76943000178215,
          "class_counts": [
            484.76943000178215,
            0.0
          ],
          "impurity": 0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      }
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.0686,
      "is_leaf": false,
      "type": "split",
      "feature_name": "spore_print_color=r",
      "feature_idx": 75,
      "split_condition": "spore_print_color=r == 1",
      "left_condition": "spore_print_color=r == 1 (TRUE)",
      "right_condition": "spore_print_color=r == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3396.113436581313,
        "class_counts": [
          3345.643566148663,
          50.46987043265021
        ],
        "impurity": 0.0293,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_surface_below_ring=y",
        "feature_idx": 111,
        "split_condition": "stalk_surface_below_ring=y == 1",
        "left_condition": "stalk_surface_below_ring=y == 1 (TRUE)",
        "right_condition": "stalk_surface_below_ring=y == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3343.939344785958,
          "class_counts": [
            3336.462326944084,
            7.477017841874106
          ],
          "impurity": 0.0045,
          "is_leaf": false,
          "type": "split",
          "feature_name": "cap_surface=g",
          "feature_idx": 19,
          "split_condition": "cap_surface=g == 1",
          "left_condition": "cap_surface=g == 1 (TRUE)",
          "right_condition": "cap_surface=g == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 3338.3315814045527,
            "class_counts": [
              3336.462326944084,
              1.8692544604685264
            ],
            "impurity": 0.0011,
            "is_leaf": false,
            "type": "split",
            "feature_name": "cap_shape=c",
            "feature_idx": 13,
            "split_condition": "cap_shape=c == 1",
            "left_condition": "cap_shape=c == 1 (TRUE)",
            "right_condition": "cap_shape=c == 0 (FALSE/NOT)",
            "left": {
              "depth": 5,
              "n_samples": 3336.462326944084,
              "class_counts": [
                3336.462326944084,
                0.0
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 0,
              "probabilities": [
                1.0,
                0.0
              ]
            },
            "right": {
              "depth": 5,
              "n_samples": 1.8692544604685264,
              "class_counts": [
                0.0,
                1.8692544604685264
              ],
              "impurity": 0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 1,
              "probabilities": [
                0.0,
                1.0
              ]
            }
          },
          "right": {
            "depth": 4,
            "n_samples": 5.6077633814055785,
            "class_counts": [
              0.0,
              5.6077633814055785
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 1,
            "probabilities": [
              0.0,
              1.0
            ]
          }
        },
        "right": {
          "depth": 3,
          "n_samples": 52.17409179535531,
          "class_counts": [
            9.181239204579207,
            42.9928525907761
          ],
          "impurity": 0.29,
          "is_leaf": false,
          "type": "split",
          "feature_name": "gill_size=n",
          "feature_idx": 37,
          "split_condition": "gill_size=n == 1",
          "left_condition": "gill_size=n == 1 (TRUE)",
          "right_condition": "gill_size=n == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 9.22462305734185,
            "class_counts": [
              9.22462305734185,
              0.0
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 0,
            "probabilities": [
              1.0,
              0.0
            ]
          },
          "right": {
            "depth": 4,
            "n_samples": 42.9928525907761,
            "class_counts": [
              0.0,
              42.9928525907761
            ],
            "impurity": 0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 1,
            "probabilities": [
              0.0,
              1.0
            ]
          }
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 72.90092395827253,
        "class_counts": [
          0.0,
          72.90092395827253
        ],
        "impurity": 0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      }
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0009323614920445829,
    0.0,
    0.0,
    0.0,
    0.002790830220784924,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.018123042261037198,
    0.0,
    0.0,
    0.019945202131617722,
    0.02477543957283661,
    0.6179087499052546,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0037757376824944047,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.16787276513871047,
    0.0,
    0.09199413250932215,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.017314615958776716,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.03456712312712062,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      0.6179087499052546
    ],
    [
      "stalk_root=c",
      0.16787276513871047
    ],
    [
      "stalk_root=r",
      0.09199413250932215
    ],
    [
      "spore_print_color=r",
      0.03456712312712062
    ],
    [
      "odor=l",
      0.02477543957283661
    ],
    [
      "odor=a",
      0.019945202131617722
    ],
    [
      "bruises=t",
      0.018123042261037198
    ],
    [
      "stalk_surface_below_ring=y",
      0.017314615958776716
    ],
    [
      "gill_size=n",
      0.0037757376824944047
    ],
    [
      "cap_surface=g",
      0.002790830220784924
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================


âœ… High-level metrics match for default_gini

Starting recursive tree comparison for default_gini...
ğŸ“ Writing detailed logs to: tree_comparison_default_gini.log
ğŸŒ² Beginning detailed recursive comparison...
ğŸŒ³ Comparing node at default_gini/root:
   Type: SPLIT, Depth: 0, Samples: 8022
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=8022, baseline=8022, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[4126.048898537895, 3895.526295616409], baseline=[4126.048898537895, 3895.526295616409]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.49960000, baseline=0.49960000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=n (idx=52)
   ğŸ“‹ Condition: odor=n == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/left:
   Type: SPLIT, Depth: 1, Samples: 4553
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=4553, baseline=4553, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[780.4053323892326, 3772.155501225486], baseline=[780.4053323892326, 3772.155501225486]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.28410000, baseline=0.28410000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_root=c (idx=99)
   ğŸ“‹ Condition: stalk_root=c == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/left/left:
   Type: SPLIT, Depth: 2, Samples: 4029
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=4029, baseline=4029, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[295.63590238745047, 3732.901157555647], baseline=[295.63590238745047, 3732.901157555647]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.13600000, baseline=0.13600000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_root=r (idx=101)
   ğŸ“‹ Condition: stalk_root=r == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/left/left/left:
   Type: SPLIT, Depth: 3, Samples: 3825
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3825, baseline=3825, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[91.81239204579207, 3732.901157555647], baseline=[91.81239204579207, 3732.901157555647]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.04690000, baseline=0.04690000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=l (idx=50)
   ğŸ“‹ Condition: odor=l == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/left/left/left/left:
   Type: SPLIT, Depth: 4, Samples: 3773
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3773, baseline=3773, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[40.39745250014851, 3732.901157555647], baseline=[40.39745250014851, 3732.901157555647]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.02120000, baseline=0.02120000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=a (idx=47)
   ğŸ“‹ Condition: odor=a == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/left/left/left/left/left:
   Type: LEAF, Depth: 5, Samples: 3733
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3733, baseline=3733, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 3732.901157555647], baseline=[0.0, 3732.901157555647]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]

ğŸŒ³ Comparing node at default_gini/root/left/left/left/left/right:
   Type: LEAF, Depth: 5, Samples: 40
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=40, baseline=40, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[40.39745250014851, 0.0], baseline=[40.39745250014851, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]


ğŸŒ³ Comparing node at default_gini/root/left/left/left/right:
   Type: LEAF, Depth: 4, Samples: 51
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=51, baseline=51, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[51.41493954564356, 0.0], baseline=[51.41493954564356, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]


ğŸŒ³ Comparing node at default_gini/root/left/left/right:
   Type: LEAF, Depth: 3, Samples: 204
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=204, baseline=204, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[203.8235103416584, 0.0], baseline=[203.8235103416584, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]


ğŸŒ³ Comparing node at default_gini/root/left/right:
   Type: SPLIT, Depth: 2, Samples: 524
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=524, baseline=524, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[484.76943000178215, 39.25434366983905], baseline=[484.76943000178215, 39.25434366983905]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.13860000, baseline=0.13860000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: bruises=t (idx=1)
   ğŸ“‹ Condition: bruises=t == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/left/right/left:
   Type: LEAF, Depth: 3, Samples: 39
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=39, baseline=39, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 39.25434366983905], baseline=[0.0, 39.25434366983905]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]

ğŸŒ³ Comparing node at default_gini/root/left/right/right:
   Type: LEAF, Depth: 3, Samples: 485
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=485, baseline=485, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[484.76943000178215, 0.0], baseline=[484.76943000178215, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]



ğŸŒ³ Comparing node at default_gini/root/right:
   Type: SPLIT, Depth: 1, Samples: 3469
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3469, baseline=3469, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 123.37079439092274], baseline=[3345.643566148663, 123.37079439092274]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.06860000, baseline=0.06860000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: spore_print_color=r (idx=75)
   ğŸ“‹ Condition: spore_print_color=r == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/right/left:
   Type: SPLIT, Depth: 2, Samples: 3396
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3396, baseline=3396, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 50.46987043265021], baseline=[3345.643566148663, 50.46987043265021]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.02930000, baseline=0.02930000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_surface_below_ring=y (idx=111)
   ğŸ“‹ Condition: stalk_surface_below_ring=y == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/right/left/left:
   Type: SPLIT, Depth: 3, Samples: 3344
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3344, baseline=3344, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3336.462326944084, 7.477017841874106], baseline=[3336.462326944084, 7.477017841874106]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00450000, baseline=0.00450000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: cap_surface=g (idx=19)
   ğŸ“‹ Condition: cap_surface=g == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/right/left/left/left:
   Type: SPLIT, Depth: 4, Samples: 3338
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3338, baseline=3338, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3336.462326944084, 1.8692544604685264], baseline=[3336.462326944084, 1.8692544604685264]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00110000, baseline=0.00110000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: cap_shape=c (idx=13)
   ğŸ“‹ Condition: cap_shape=c == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/right/left/left/left/left:
   Type: LEAF, Depth: 5, Samples: 3336
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3336, baseline=3336, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3336.462326944084, 0.0], baseline=[3336.462326944084, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]

ğŸŒ³ Comparing node at default_gini/root/right/left/left/left/right:
   Type: LEAF, Depth: 5, Samples: 2
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=2, baseline=2, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 1.8692544604685264], baseline=[0.0, 1.8692544604685264]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]


ğŸŒ³ Comparing node at default_gini/root/right/left/left/right:
   Type: LEAF, Depth: 4, Samples: 6
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=6, baseline=6, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 5.6077633814055785], baseline=[0.0, 5.6077633814055785]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]


ğŸŒ³ Comparing node at default_gini/root/right/left/right:
   Type: SPLIT, Depth: 3, Samples: 52
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=52, baseline=52, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[9.181239204579207, 42.9928525907761], baseline=[9.181239204579207, 42.9928525907761]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.29000000, baseline=0.29000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: gill_size=n (idx=37)
   ğŸ“‹ Condition: gill_size=n == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at default_gini/root/right/left/right/left:
   Type: LEAF, Depth: 4, Samples: 9
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=9, baseline=9, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[9.22462305734185, 0.0], baseline=[9.22462305734185, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]

ğŸŒ³ Comparing node at default_gini/root/right/left/right/right:
   Type: LEAF, Depth: 4, Samples: 43
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=43, baseline=43, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 42.9928525907761], baseline=[0.0, 42.9928525907761]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]



ğŸŒ³ Comparing node at default_gini/root/right/right:
   Type: LEAF, Depth: 2, Samples: 73
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=73, baseline=73, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 72.90092395827253], baseline=[0.0, 72.90092395827253]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]



âœ… Recursive tree comparison completed for default_gini
ğŸ“„ Detailed log saved to: tree_comparison_default_gini.log
PASSED
tests/integration/mushroom/test_mushroom_regression.py::TestMushroomRegression::test_core_criteria_regression[entropy_shallow] 
============================================================
CURRENT OUTPUT FOR ENTROPY_SHALLOW:
============================================================
{
  "description": "Entropy criterion, shallow tree (depth 3)",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.9994,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.6609,
      "is_leaf": false,
      "type": "split",
      "feature_name": "bruises=t",
      "feature_idx": 1,
      "split_condition": "bruises=t == 1",
      "left_condition": "bruises=t == 1 (TRUE)",
      "right_condition": "bruises=t == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3241.2872344524244,
        "class_counts": [
          0.0,
          3241.2872344524244
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      },
      "right": {
        "depth": 2,
        "n_samples": 1311.273599162294,
        "class_counts": [
          780.4053323892326,
          530.8682667730615
        ],
        "impurity": 0.9737,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_root=c",
        "feature_idx": 99,
        "split_condition": "stalk_root=c == 1",
        "left_condition": "stalk_root=c == 1 (TRUE)",
        "right_condition": "stalk_root=c == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 826.504169160512,
          "class_counts": [
            295.63590238745047,
            530.8682667730615
          ],
          "impurity": 0.9408,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.3577,
            0.6423
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 484.76943000178215,
          "class_counts": [
            484.76943000178215,
            0.0
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      }
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.2216,
      "is_leaf": false,
      "type": "split",
      "feature_name": "spore_print_color=r",
      "feature_idx": 75,
      "split_condition": "spore_print_color=r == 1",
      "left_condition": "spore_print_color=r == 1 (TRUE)",
      "right_condition": "spore_print_color=r == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3396.113436581313,
        "class_counts": [
          3345.643566148663,
          50.46987043265021
        ],
        "impurity": 0.1115,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_surface_below_ring=y",
        "feature_idx": 111,
        "split_condition": "stalk_surface_below_ring=y == 1",
        "left_condition": "stalk_surface_below_ring=y == 1 (TRUE)",
        "right_condition": "stalk_surface_below_ring=y == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3343.939344785958,
          "class_counts": [
            3336.462326944084,
            7.477017841874106
          ],
          "impurity": 0.0229,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            0.9978,
            0.0022
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 52.17409179535531,
          "class_counts": [
            9.181239204579207,
            42.9928525907761
          ],
          "impurity": 0.6712,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.176,
            0.824
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 72.90092395827253,
        "class_counts": [
          0.0,
          72.90092395827253
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      }
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.24302401049899225,
    0.0,
    0.0,
    0.0,
    0.0,
    0.5947526853494699,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0700475234402449,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.037475312181446105,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.054700468529846884,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      0.5947526853494699
    ],
    [
      "bruises=t",
      0.24302401049899225
    ],
    [
      "stalk_root=c",
      0.0700475234402449
    ],
    [
      "spore_print_color=r",
      0.054700468529846884
    ],
    [
      "stalk_surface_below_ring=y",
      0.037475312181446105
    ],
    [
      "cap_shape=x",
      0.0
    ],
    [
      "cap_shape=b",
      0.0
    ],
    [
      "cap_shape=s",
      0.0
    ],
    [
      "cap_shape=f",
      0.0
    ],
    [
      "cap_shape=k",
      0.0
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================

============================================================
BASELINE OUTPUT FOR ENTROPY_SHALLOW:
============================================================
{
  "description": "Entropy criterion, shallow tree (depth 3)",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.9994,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.6609,
      "is_leaf": false,
      "type": "split",
      "feature_name": "bruises=t",
      "feature_idx": 1,
      "split_condition": "bruises=t == 1",
      "left_condition": "bruises=t == 1 (TRUE)",
      "right_condition": "bruises=t == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3241.2872344524244,
        "class_counts": [
          0.0,
          3241.2872344524244
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      },
      "right": {
        "depth": 2,
        "n_samples": 1311.273599162294,
        "class_counts": [
          780.4053323892326,
          530.8682667730615
        ],
        "impurity": 0.9737,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_root=c",
        "feature_idx": 99,
        "split_condition": "stalk_root=c == 1",
        "left_condition": "stalk_root=c == 1 (TRUE)",
        "right_condition": "stalk_root=c == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 826.504169160512,
          "class_counts": [
            295.63590238745047,
            530.8682667730615
          ],
          "impurity": 0.9408,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.3577,
            0.6423
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 484.76943000178215,
          "class_counts": [
            484.76943000178215,
            0.0
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      }
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.2216,
      "is_leaf": false,
      "type": "split",
      "feature_name": "spore_print_color=r",
      "feature_idx": 75,
      "split_condition": "spore_print_color=r == 1",
      "left_condition": "spore_print_color=r == 1 (TRUE)",
      "right_condition": "spore_print_color=r == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3396.113436581313,
        "class_counts": [
          3345.643566148663,
          50.46987043265021
        ],
        "impurity": 0.1115,
        "is_leaf": false,
        "type": "split",
        "feature_name": "stalk_surface_below_ring=y",
        "feature_idx": 111,
        "split_condition": "stalk_surface_below_ring=y == 1",
        "left_condition": "stalk_surface_below_ring=y == 1 (TRUE)",
        "right_condition": "stalk_surface_below_ring=y == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3343.939344785958,
          "class_counts": [
            3336.462326944084,
            7.477017841874106
          ],
          "impurity": 0.0229,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            0.9978,
            0.0022
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 52.17409179535531,
          "class_counts": [
            9.181239204579207,
            42.9928525907761
          ],
          "impurity": 0.6712,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.176,
            0.824
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 72.90092395827253,
        "class_counts": [
          0.0,
          72.90092395827253
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      }
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.24302401049899225,
    0.0,
    0.0,
    0.0,
    0.0,
    0.5947526853494699,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0700475234402449,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.037475312181446105,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.054700468529846884,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      0.5947526853494699
    ],
    [
      "bruises=t",
      0.24302401049899225
    ],
    [
      "stalk_root=c",
      0.0700475234402449
    ],
    [
      "spore_print_color=r",
      0.054700468529846884
    ],
    [
      "stalk_surface_below_ring=y",
      0.037475312181446105
    ],
    [
      "cap_shape=x",
      0.0
    ],
    [
      "cap_shape=b",
      0.0
    ],
    [
      "cap_shape=s",
      0.0
    ],
    [
      "cap_shape=f",
      0.0
    ],
    [
      "cap_shape=k",
      0.0
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================


âœ… High-level metrics match for entropy_shallow

Starting recursive tree comparison for entropy_shallow...
ğŸ“ Writing detailed logs to: tree_comparison_entropy_shallow.log
ğŸŒ² Beginning detailed recursive comparison...
ğŸŒ³ Comparing node at entropy_shallow/root:
   Type: SPLIT, Depth: 0, Samples: 8022
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=8022, baseline=8022, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[4126.048898537895, 3895.526295616409], baseline=[4126.048898537895, 3895.526295616409]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.99940000, baseline=0.99940000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=n (idx=52)
   ğŸ“‹ Condition: odor=n == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at entropy_shallow/root/left:
   Type: SPLIT, Depth: 1, Samples: 4553
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=4553, baseline=4553, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[780.4053323892326, 3772.155501225486], baseline=[780.4053323892326, 3772.155501225486]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.66090000, baseline=0.66090000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: bruises=t (idx=1)
   ğŸ“‹ Condition: bruises=t == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at entropy_shallow/root/left/left:
   Type: LEAF, Depth: 2, Samples: 3241
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3241, baseline=3241, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 3241.2872344524244], baseline=[0.0, 3241.2872344524244]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]

ğŸŒ³ Comparing node at entropy_shallow/root/left/right:
   Type: SPLIT, Depth: 2, Samples: 1311
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=1311, baseline=1311, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[780.4053323892326, 530.8682667730615], baseline=[780.4053323892326, 530.8682667730615]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.97370000, baseline=0.97370000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_root=c (idx=99)
   ğŸ“‹ Condition: stalk_root=c == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at entropy_shallow/root/left/right/left:
   Type: LEAF, Depth: 3, Samples: 827
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=827, baseline=827, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[295.63590238745047, 530.8682667730615], baseline=[295.63590238745047, 530.8682667730615]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.94080000, baseline=0.94080000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.3577, 0.6423]

ğŸŒ³ Comparing node at entropy_shallow/root/left/right/right:
   Type: LEAF, Depth: 3, Samples: 485
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=485, baseline=485, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[484.76943000178215, 0.0], baseline=[484.76943000178215, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]



ğŸŒ³ Comparing node at entropy_shallow/root/right:
   Type: SPLIT, Depth: 1, Samples: 3469
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3469, baseline=3469, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 123.37079439092274], baseline=[3345.643566148663, 123.37079439092274]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.22160000, baseline=0.22160000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: spore_print_color=r (idx=75)
   ğŸ“‹ Condition: spore_print_color=r == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at entropy_shallow/root/right/left:
   Type: SPLIT, Depth: 2, Samples: 3396
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3396, baseline=3396, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 50.46987043265021], baseline=[3345.643566148663, 50.46987043265021]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.11150000, baseline=0.11150000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_surface_below_ring=y (idx=111)
   ğŸ“‹ Condition: stalk_surface_below_ring=y == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at entropy_shallow/root/right/left/left:
   Type: LEAF, Depth: 3, Samples: 3344
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3344, baseline=3344, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3336.462326944084, 7.477017841874106], baseline=[3336.462326944084, 7.477017841874106]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.02290000, baseline=0.02290000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [0.9978, 0.0022]

ğŸŒ³ Comparing node at entropy_shallow/root/right/left/right:
   Type: LEAF, Depth: 3, Samples: 52
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=52, baseline=52, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[9.181239204579207, 42.9928525907761], baseline=[9.181239204579207, 42.9928525907761]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.67120000, baseline=0.67120000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.176, 0.824]


ğŸŒ³ Comparing node at entropy_shallow/root/right/right:
   Type: LEAF, Depth: 2, Samples: 73
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=73, baseline=73, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 72.90092395827253], baseline=[0.0, 72.90092395827253]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]



âœ… Recursive tree comparison completed for entropy_shallow
ğŸ“„ Detailed log saved to: tree_comparison_entropy_shallow.log
PASSED
tests/integration/mushroom/test_mushroom_regression.py::TestMushroomRegression::test_core_criteria_regression[gain_ratio_medium] 
============================================================
CURRENT OUTPUT FOR GAIN_RATIO_MEDIUM:
============================================================
{
  "description": "Gain ratio criterion, medium depth",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.9994,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.6609,
      "is_leaf": false,
      "type": "split",
      "feature_name": "odor=l",
      "feature_idx": 50,
      "split_condition": "odor=l == 1",
      "left_condition": "odor=l == 1 (TRUE)",
      "right_condition": "odor=l == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 4150.422556454149,
        "class_counts": [
          378.2670552286633,
          3772.155501225486
        ],
        "impurity": 0.4403,
        "is_leaf": false,
        "type": "split",
        "feature_name": "odor=a",
        "feature_idx": 47,
        "split_condition": "odor=a == 1",
        "left_condition": "odor=a == 1 (TRUE)",
        "right_condition": "odor=a == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3772.155501225486,
          "class_counts": [
            0.0,
            3772.155501225486
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.0,
            1.0
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 378.2670552286633,
          "class_counts": [
            378.2670552286633,
            0.0
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 402.13827716056926,
        "class_counts": [
          402.13827716056926,
          0.0
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 0,
        "probabilities": [
          1.0,
          0.0
        ]
      }
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.2216,
      "is_leaf": false,
      "type": "split",
      "feature_name": "spore_print_color=r",
      "feature_idx": 75,
      "split_condition": "spore_print_color=r == 1",
      "left_condition": "spore_print_color=r == 1 (TRUE)",
      "right_condition": "spore_print_color=r == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3396.113436581313,
        "class_counts": [
          3345.643566148663,
          50.46987043265021
        ],
        "impurity": 0.1115,
        "is_leaf": false,
        "type": "split",
        "feature_name": "cap_color=y",
        "feature_idx": 11,
        "split_condition": "cap_color=y == 1",
        "left_condition": "cap_color=y == 1 (TRUE)",
        "right_condition": "cap_color=y == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3369.943874134754,
          "class_counts": [
            3345.643566148663,
            24.300307986090843
          ],
          "impurity": 0.0617,
          "is_leaf": false,
          "type": "split",
          "feature_name": "stalk_color_below_ring=y",
          "feature_idx": 96,
          "split_condition": "stalk_color_below_ring=y == 1",
          "left_condition": "stalk_color_below_ring=y == 1 (TRUE)",
          "right_condition": "stalk_color_below_ring=y == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 3362.4668562928796,
            "class_counts": [
              3345.643566148663,
              16.823290144216738
            ],
            "impurity": 0.0454,
            "is_leaf": false,
            "type": "split",
            "feature_name": "cap_surface=g",
            "feature_idx": 19,
            "split_condition": "cap_surface=g == 1",
            "left_condition": "cap_surface=g == 1 (TRUE)",
            "right_condition": "cap_surface=g == 0 (FALSE/NOT)",
            "left": {
              "depth": 5,
              "n_samples": 3356.8590929114744,
              "class_counts": [
                3345.643566148663,
                11.215526762811157
              ],
              "impurity": 0.0323,
              "is_leaf": false,
              "type": "split",
              "feature_name": "cap_shape=c",
              "feature_idx": 13,
              "split_condition": "cap_shape=c == 1",
              "left_condition": "cap_shape=c == 1 (TRUE)",
              "right_condition": "cap_shape=c == 0 (FALSE/NOT)",
              "left": {
                "depth": 6,
                "n_samples": 3354.9898384510057,
                "class_counts": [
                  3345.643566148663,
                  9.346272302342632
                ],
                "impurity": 0.0277,
                "is_leaf": false,
                "type": "split",
                "feature_name": "stalk_surface_below_ring=y",
                "feature_idx": 111,
                "split_condition": "stalk_surface_below_ring=y == 1",
                "left_condition": "stalk_surface_below_ring=y == 1 (TRUE)",
                "right_condition": "stalk_surface_below_ring=y == 0 (FALSE/NOT)",
                "left": {
                  "depth": 7,
                  "n_samples": 3336.462326944084,
                  "class_counts": [
                    3336.462326944084,
                    0.0
                  ],
                  "impurity": -0.0,
                  "is_leaf": true,
                  "type": "leaf",
                  "prediction": 0,
                  "probabilities": [
                    1.0,
                    0.0
                  ]
                },
                "right": {
                  "depth": 7,
                  "n_samples": 18.52751150692184,
                  "class_counts": [
                    9.181239204579207,
                    9.346272302342632
                  ],
                  "impurity": 0.9999,
                  "is_leaf": true,
                  "type": "leaf",
                  "prediction": 1,
                  "probabilities": [
                    0.4955,
                    0.5045
                  ]
                }
              },
              "right": {
                "depth": 6,
                "n_samples": 1.8692544604685264,
                "class_counts": [
                  0.0,
                  1.8692544604685264
                ],
                "impurity": -0.0,
                "is_leaf": true,
                "type": "leaf",
                "prediction": 1,
                "probabilities": [
                  0.0,
                  1.0
                ]
              }
            },
            "right": {
              "depth": 5,
              "n_samples": 5.6077633814055785,
              "class_counts": [
                0.0,
                5.6077633814055785
              ],
              "impurity": -0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 1,
              "probabilities": [
                0.0,
                1.0
              ]
            }
          },
          "right": {
            "depth": 4,
            "n_samples": 7.477017841874106,
            "class_counts": [
              0.0,
              7.477017841874106
            ],
            "impurity": -0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 1,
            "probabilities": [
              0.0,
              1.0
            ]
          }
        },
        "right": {
          "depth": 3,
          "n_samples": 26.169562446559368,
          "class_counts": [
            0.0,
            26.169562446559368
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.0,
            1.0
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 72.90092395827253,
        "class_counts": [
          0.0,
          72.90092395827253
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      }
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0019520622815107668,
    0.0,
    0.0,
    0.0,
    0.0055490186985316,
    0.0,
    0.02136654347904997,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.2284583929254036,
    0.14774733046458957,
    0.5300119412890015,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.009285376344240549,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.006883188045232847,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.04874614647243967,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      0.5300119412890015
    ],
    [
      "odor=a",
      0.2284583929254036
    ],
    [
      "odor=l",
      0.14774733046458957
    ],
    [
      "spore_print_color=r",
      0.04874614647243967
    ],
    [
      "cap_color=y",
      0.02136654347904997
    ],
    [
      "stalk_surface_below_ring=y",
      0.009285376344240549
    ],
    [
      "stalk_color_below_ring=y",
      0.006883188045232847
    ],
    [
      "cap_surface=g",
      0.0055490186985316
    ],
    [
      "cap_shape=c",
      0.0019520622815107668
    ],
    [
      "cap_shape=x",
      0.0
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================

============================================================
BASELINE OUTPUT FOR GAIN_RATIO_MEDIUM:
============================================================
{
  "description": "Gain ratio criterion, medium depth",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.9994,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.6609,
      "is_leaf": false,
      "type": "split",
      "feature_name": "odor=l",
      "feature_idx": 50,
      "split_condition": "odor=l == 1",
      "left_condition": "odor=l == 1 (TRUE)",
      "right_condition": "odor=l == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 4150.422556454149,
        "class_counts": [
          378.2670552286633,
          3772.155501225486
        ],
        "impurity": 0.4403,
        "is_leaf": false,
        "type": "split",
        "feature_name": "odor=a",
        "feature_idx": 47,
        "split_condition": "odor=a == 1",
        "left_condition": "odor=a == 1 (TRUE)",
        "right_condition": "odor=a == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3772.155501225486,
          "class_counts": [
            0.0,
            3772.155501225486
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.0,
            1.0
          ]
        },
        "right": {
          "depth": 3,
          "n_samples": 378.2670552286633,
          "class_counts": [
            378.2670552286633,
            0.0
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 0,
          "probabilities": [
            1.0,
            0.0
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 402.13827716056926,
        "class_counts": [
          402.13827716056926,
          0.0
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 0,
        "probabilities": [
          1.0,
          0.0
        ]
      }
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.2216,
      "is_leaf": false,
      "type": "split",
      "feature_name": "spore_print_color=r",
      "feature_idx": 75,
      "split_condition": "spore_print_color=r == 1",
      "left_condition": "spore_print_color=r == 1 (TRUE)",
      "right_condition": "spore_print_color=r == 0 (FALSE/NOT)",
      "left": {
        "depth": 2,
        "n_samples": 3396.113436581313,
        "class_counts": [
          3345.643566148663,
          50.46987043265021
        ],
        "impurity": 0.1115,
        "is_leaf": false,
        "type": "split",
        "feature_name": "cap_color=y",
        "feature_idx": 11,
        "split_condition": "cap_color=y == 1",
        "left_condition": "cap_color=y == 1 (TRUE)",
        "right_condition": "cap_color=y == 0 (FALSE/NOT)",
        "left": {
          "depth": 3,
          "n_samples": 3369.943874134754,
          "class_counts": [
            3345.643566148663,
            24.300307986090843
          ],
          "impurity": 0.0617,
          "is_leaf": false,
          "type": "split",
          "feature_name": "stalk_color_below_ring=y",
          "feature_idx": 96,
          "split_condition": "stalk_color_below_ring=y == 1",
          "left_condition": "stalk_color_below_ring=y == 1 (TRUE)",
          "right_condition": "stalk_color_below_ring=y == 0 (FALSE/NOT)",
          "left": {
            "depth": 4,
            "n_samples": 3362.4668562928796,
            "class_counts": [
              3345.643566148663,
              16.823290144216738
            ],
            "impurity": 0.0454,
            "is_leaf": false,
            "type": "split",
            "feature_name": "cap_surface=g",
            "feature_idx": 19,
            "split_condition": "cap_surface=g == 1",
            "left_condition": "cap_surface=g == 1 (TRUE)",
            "right_condition": "cap_surface=g == 0 (FALSE/NOT)",
            "left": {
              "depth": 5,
              "n_samples": 3356.8590929114744,
              "class_counts": [
                3345.643566148663,
                11.215526762811157
              ],
              "impurity": 0.0323,
              "is_leaf": false,
              "type": "split",
              "feature_name": "cap_shape=c",
              "feature_idx": 13,
              "split_condition": "cap_shape=c == 1",
              "left_condition": "cap_shape=c == 1 (TRUE)",
              "right_condition": "cap_shape=c == 0 (FALSE/NOT)",
              "left": {
                "depth": 6,
                "n_samples": 3354.9898384510057,
                "class_counts": [
                  3345.643566148663,
                  9.346272302342632
                ],
                "impurity": 0.0277,
                "is_leaf": false,
                "type": "split",
                "feature_name": "stalk_surface_below_ring=y",
                "feature_idx": 111,
                "split_condition": "stalk_surface_below_ring=y == 1",
                "left_condition": "stalk_surface_below_ring=y == 1 (TRUE)",
                "right_condition": "stalk_surface_below_ring=y == 0 (FALSE/NOT)",
                "left": {
                  "depth": 7,
                  "n_samples": 3336.462326944084,
                  "class_counts": [
                    3336.462326944084,
                    0.0
                  ],
                  "impurity": -0.0,
                  "is_leaf": true,
                  "type": "leaf",
                  "prediction": 0,
                  "probabilities": [
                    1.0,
                    0.0
                  ]
                },
                "right": {
                  "depth": 7,
                  "n_samples": 18.52751150692184,
                  "class_counts": [
                    9.181239204579207,
                    9.346272302342632
                  ],
                  "impurity": 0.9999,
                  "is_leaf": true,
                  "type": "leaf",
                  "prediction": 1,
                  "probabilities": [
                    0.4955,
                    0.5045
                  ]
                }
              },
              "right": {
                "depth": 6,
                "n_samples": 1.8692544604685264,
                "class_counts": [
                  0.0,
                  1.8692544604685264
                ],
                "impurity": -0.0,
                "is_leaf": true,
                "type": "leaf",
                "prediction": 1,
                "probabilities": [
                  0.0,
                  1.0
                ]
              }
            },
            "right": {
              "depth": 5,
              "n_samples": 5.6077633814055785,
              "class_counts": [
                0.0,
                5.6077633814055785
              ],
              "impurity": -0.0,
              "is_leaf": true,
              "type": "leaf",
              "prediction": 1,
              "probabilities": [
                0.0,
                1.0
              ]
            }
          },
          "right": {
            "depth": 4,
            "n_samples": 7.477017841874106,
            "class_counts": [
              0.0,
              7.477017841874106
            ],
            "impurity": -0.0,
            "is_leaf": true,
            "type": "leaf",
            "prediction": 1,
            "probabilities": [
              0.0,
              1.0
            ]
          }
        },
        "right": {
          "depth": 3,
          "n_samples": 26.169562446559368,
          "class_counts": [
            0.0,
            26.169562446559368
          ],
          "impurity": -0.0,
          "is_leaf": true,
          "type": "leaf",
          "prediction": 1,
          "probabilities": [
            0.0,
            1.0
          ]
        }
      },
      "right": {
        "depth": 2,
        "n_samples": 72.90092395827253,
        "class_counts": [
          0.0,
          72.90092395827253
        ],
        "impurity": -0.0,
        "is_leaf": true,
        "type": "leaf",
        "prediction": 1,
        "probabilities": [
          0.0,
          1.0
        ]
      }
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0019520622815107668,
    0.0,
    0.0,
    0.0,
    0.0055490186985316,
    0.0,
    0.02136654347904997,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.2284583929254036,
    0.14774733046458957,
    0.5300119412890015,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.009285376344240549,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.006883188045232847,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.04874614647243967,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      0.5300119412890015
    ],
    [
      "odor=a",
      0.2284583929254036
    ],
    [
      "odor=l",
      0.14774733046458957
    ],
    [
      "spore_print_color=r",
      0.04874614647243967
    ],
    [
      "cap_color=y",
      0.02136654347904997
    ],
    [
      "stalk_surface_below_ring=y",
      0.009285376344240549
    ],
    [
      "stalk_color_below_ring=y",
      0.006883188045232847
    ],
    [
      "cap_surface=g",
      0.0055490186985316
    ],
    [
      "cap_shape=c",
      0.0019520622815107668
    ],
    [
      "cap_shape=x",
      0.0
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================


âœ… High-level metrics match for gain_ratio_medium

Starting recursive tree comparison for gain_ratio_medium...
ğŸ“ Writing detailed logs to: tree_comparison_gain_ratio_medium.log
ğŸŒ² Beginning detailed recursive comparison...
ğŸŒ³ Comparing node at gain_ratio_medium/root:
   Type: SPLIT, Depth: 0, Samples: 8022
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=8022, baseline=8022, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[4126.048898537895, 3895.526295616409], baseline=[4126.048898537895, 3895.526295616409]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.99940000, baseline=0.99940000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=n (idx=52)
   ğŸ“‹ Condition: odor=n == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/left:
   Type: SPLIT, Depth: 1, Samples: 4553
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=4553, baseline=4553, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[780.4053323892326, 3772.155501225486], baseline=[780.4053323892326, 3772.155501225486]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.66090000, baseline=0.66090000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=l (idx=50)
   ğŸ“‹ Condition: odor=l == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/left/left:
   Type: SPLIT, Depth: 2, Samples: 4150
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=4150, baseline=4150, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[378.2670552286633, 3772.155501225486], baseline=[378.2670552286633, 3772.155501225486]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.44030000, baseline=0.44030000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=a (idx=47)
   ğŸ“‹ Condition: odor=a == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/left/left/left:
   Type: LEAF, Depth: 3, Samples: 3772
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3772, baseline=3772, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 3772.155501225486], baseline=[0.0, 3772.155501225486]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]

ğŸŒ³ Comparing node at gain_ratio_medium/root/left/left/right:
   Type: LEAF, Depth: 3, Samples: 378
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=378, baseline=378, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[378.2670552286633, 0.0], baseline=[378.2670552286633, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]


ğŸŒ³ Comparing node at gain_ratio_medium/root/left/right:
   Type: LEAF, Depth: 2, Samples: 402
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=402, baseline=402, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[402.13827716056926, 0.0], baseline=[402.13827716056926, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]


ğŸŒ³ Comparing node at gain_ratio_medium/root/right:
   Type: SPLIT, Depth: 1, Samples: 3469
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3469, baseline=3469, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 123.37079439092274], baseline=[3345.643566148663, 123.37079439092274]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.22160000, baseline=0.22160000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: spore_print_color=r (idx=75)
   ğŸ“‹ Condition: spore_print_color=r == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left:
   Type: SPLIT, Depth: 2, Samples: 3396
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3396, baseline=3396, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 50.46987043265021], baseline=[3345.643566148663, 50.46987043265021]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.11150000, baseline=0.11150000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: cap_color=y (idx=11)
   ğŸ“‹ Condition: cap_color=y == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left:
   Type: SPLIT, Depth: 3, Samples: 3370
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3370, baseline=3370, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 24.300307986090843], baseline=[3345.643566148663, 24.300307986090843]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.06170000, baseline=0.06170000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_color_below_ring=y (idx=96)
   ğŸ“‹ Condition: stalk_color_below_ring=y == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left:
   Type: SPLIT, Depth: 4, Samples: 3362
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3362, baseline=3362, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 16.823290144216738], baseline=[3345.643566148663, 16.823290144216738]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.04540000, baseline=0.04540000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: cap_surface=g (idx=19)
   ğŸ“‹ Condition: cap_surface=g == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left/left:
   Type: SPLIT, Depth: 5, Samples: 3357
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3357, baseline=3357, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 11.215526762811157], baseline=[3345.643566148663, 11.215526762811157]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.03230000, baseline=0.03230000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: cap_shape=c (idx=13)
   ğŸ“‹ Condition: cap_shape=c == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left/left/left:
   Type: SPLIT, Depth: 6, Samples: 3355
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3355, baseline=3355, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 9.346272302342632], baseline=[3345.643566148663, 9.346272302342632]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.02770000, baseline=0.02770000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: stalk_surface_below_ring=y (idx=111)
   ğŸ“‹ Condition: stalk_surface_below_ring=y == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left/left/left/left:
   Type: LEAF, Depth: 7, Samples: 3336
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3336, baseline=3336, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3336.462326944084, 0.0], baseline=[3336.462326944084, 0.0]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [1.0, 0.0]

ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left/left/left/right:
   Type: LEAF, Depth: 7, Samples: 19
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=19, baseline=19, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[9.181239204579207, 9.346272302342632], baseline=[9.181239204579207, 9.346272302342632]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.99990000, baseline=0.99990000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.4955, 0.5045]


ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left/left/right:
   Type: LEAF, Depth: 6, Samples: 2
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=2, baseline=2, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 1.8692544604685264], baseline=[0.0, 1.8692544604685264]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]


ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/left/right:
   Type: LEAF, Depth: 5, Samples: 6
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=6, baseline=6, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 5.6077633814055785], baseline=[0.0, 5.6077633814055785]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]


ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/left/right:
   Type: LEAF, Depth: 4, Samples: 7
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=7, baseline=7, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 7.477017841874106], baseline=[0.0, 7.477017841874106]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]


ğŸŒ³ Comparing node at gain_ratio_medium/root/right/left/right:
   Type: LEAF, Depth: 3, Samples: 26
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=26, baseline=26, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 26.169562446559368], baseline=[0.0, 26.169562446559368]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]


ğŸŒ³ Comparing node at gain_ratio_medium/root/right/right:
   Type: LEAF, Depth: 2, Samples: 73
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=73, baseline=73, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[0.0, 72.90092395827253], baseline=[0.0, 72.90092395827253]
   âœ… Class counts match
   ğŸ¯ Impurity: current=-0.00000000, baseline=-0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.0, 1.0]



âœ… Recursive tree comparison completed for gain_ratio_medium
ğŸ“„ Detailed log saved to: tree_comparison_gain_ratio_medium.log
PASSED
tests/integration/mushroom/test_mushroom_regression.py::TestMushroomRegression::test_core_criteria_regression[binomial_deep] 
============================================================
CURRENT OUTPUT FOR BINOMIAL_DEEP:
============================================================
{
  "description": "Binomial criterion, deeper tree",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.0102,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.0,
      "is_leaf": true,
      "type": "leaf",
      "prediction": 1,
      "probabilities": [
        0.1714,
        0.8286
      ]
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.0,
      "is_leaf": true,
      "type": "leaf",
      "prediction": 0,
      "probabilities": [
        0.9644,
        0.0356
      ]
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    1.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      1.0
    ],
    [
      "cap_shape=x",
      0.0
    ],
    [
      "cap_shape=b",
      0.0
    ],
    [
      "cap_shape=s",
      0.0
    ],
    [
      "cap_shape=f",
      0.0
    ],
    [
      "cap_shape=k",
      0.0
    ],
    [
      "cap_shape=c",
      0.0
    ],
    [
      "cap_surface=s",
      0.0
    ],
    [
      "cap_surface=y",
      0.0
    ],
    [
      "cap_surface=f",
      0.0
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================

============================================================
BASELINE OUTPUT FOR BINOMIAL_DEEP:
============================================================
{
  "description": "Binomial criterion, deeper tree",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.0102,
    "is_leaf": false,
    "type": "split",
    "feature_name": "odor=n",
    "feature_idx": 52,
    "split_condition": "odor=n == 1",
    "left_condition": "odor=n == 1 (TRUE)",
    "right_condition": "odor=n == 0 (FALSE/NOT)",
    "left": {
      "depth": 1,
      "n_samples": 4552.560833614719,
      "class_counts": [
        780.4053323892326,
        3772.155501225486
      ],
      "impurity": 0.0,
      "is_leaf": true,
      "type": "leaf",
      "prediction": 1,
      "probabilities": [
        0.1714,
        0.8286
      ]
    },
    "right": {
      "depth": 1,
      "n_samples": 3469.0143605395856,
      "class_counts": [
        3345.643566148663,
        123.37079439092274
      ],
      "impurity": 0.0,
      "is_leaf": true,
      "type": "leaf",
      "prediction": 0,
      "probabilities": [
        0.9644,
        0.0356
      ]
    }
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    1.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ],
  "top_features": [
    [
      "odor=n",
      1.0
    ],
    [
      "cap_shape=x",
      0.0
    ],
    [
      "cap_shape=b",
      0.0
    ],
    [
      "cap_shape=s",
      0.0
    ],
    [
      "cap_shape=f",
      0.0
    ],
    [
      "cap_shape=k",
      0.0
    ],
    [
      "cap_shape=c",
      0.0
    ],
    [
      "cap_surface=s",
      0.0
    ],
    [
      "cap_surface=y",
      0.0
    ],
    [
      "cap_surface=f",
      0.0
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================


âœ… High-level metrics match for binomial_deep

Starting recursive tree comparison for binomial_deep...
ğŸ“ Writing detailed logs to: tree_comparison_binomial_deep.log
ğŸŒ² Beginning detailed recursive comparison...
ğŸŒ³ Comparing node at binomial_deep/root:
   Type: SPLIT, Depth: 0, Samples: 8022
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=8022, baseline=8022, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[4126.048898537895, 3895.526295616409], baseline=[4126.048898537895, 3895.526295616409]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.01020000, baseline=0.01020000, diff=0.00e+00
   âœ… Impurity matches
   ğŸ”€ Split feature: odor=n (idx=52)
   ğŸ“‹ Condition: odor=n == 1
   âœ… Split feature matches
   âœ… Both children present

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸŒ³ Comparing node at binomial_deep/root/left:
   Type: LEAF, Depth: 1, Samples: 4553
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=4553, baseline=4553, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[780.4053323892326, 3772.155501225486], baseline=[780.4053323892326, 3772.155501225486]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 1
   ğŸ“Š Probabilities: [0.1714, 0.8286]

ğŸŒ³ Comparing node at binomial_deep/root/right:
   Type: LEAF, Depth: 1, Samples: 3469
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=3469, baseline=3469, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[3345.643566148663, 123.37079439092274], baseline=[3345.643566148663, 123.37079439092274]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [0.9644, 0.0356]


âœ… Recursive tree comparison completed for binomial_deep
ğŸ“„ Detailed log saved to: tree_comparison_binomial_deep.log
PASSED
tests/integration/mushroom/test_mushroom_regression.py::TestMushroomRegression::test_core_criteria_regression[chi_square_default] 
============================================================
CURRENT OUTPUT FOR CHI_SQUARE_DEFAULT:
============================================================
{
  "description": "Chi-square criterion, default depth",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.0,
    "is_leaf": true,
    "type": "leaf",
    "prediction": 0,
    "probabilities": [
      0.5144,
      0.4856
    ]
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548
  ],
  "top_features": [
    [
      "cap_shape=x",
      0.008547008547008548
    ],
    [
      "cap_shape=b",
      0.008547008547008548
    ],
    [
      "cap_shape=s",
      0.008547008547008548
    ],
    [
      "cap_shape=f",
      0.008547008547008548
    ],
    [
      "cap_shape=k",
      0.008547008547008548
    ],
    [
      "cap_shape=c",
      0.008547008547008548
    ],
    [
      "cap_surface=s",
      0.008547008547008548
    ],
    [
      "cap_surface=y",
      0.008547008547008548
    ],
    [
      "cap_surface=f",
      0.008547008547008548
    ],
    [
      "cap_surface=g",
      0.008547008547008548
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================

============================================================
BASELINE OUTPUT FOR CHI_SQUARE_DEFAULT:
============================================================
{
  "description": "Chi-square criterion, default depth",
  "tree_structure": {
    "depth": 0,
    "n_samples": 8021.575194154304,
    "class_counts": [
      4126.048898537895,
      3895.526295616409
    ],
    "impurity": 0.0,
    "is_leaf": true,
    "type": "leaf",
    "prediction": 0,
    "probabilities": [
      0.5144,
      0.4856
    ]
  },
  "tree_depth": 0,
  "n_samples": 8021.575194154304,
  "feature_importances": [
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548,
    0.008547008547008548
  ],
  "top_features": [
    [
      "cap_shape=x",
      0.008547008547008548
    ],
    [
      "cap_shape=b",
      0.008547008547008548
    ],
    [
      "cap_shape=s",
      0.008547008547008548
    ],
    [
      "cap_shape=f",
      0.008547008547008548
    ],
    [
      "cap_shape=k",
      0.008547008547008548
    ],
    [
      "cap_shape=c",
      0.008547008547008548
    ],
    [
      "cap_surface=s",
      0.008547008547008548
    ],
    [
      "cap_surface=y",
      0.008547008547008548
    ],
    [
      "cap_surface=f",
      0.008547008547008548
    ],
    [
      "cap_surface=g",
      0.008547008547008548
    ]
  ],
  "n_features": 117,
  "classes": [
    0,
    1
  ]
}
============================================================


âœ… High-level metrics match for chi_square_default

Starting recursive tree comparison for chi_square_default...
ğŸ“ Writing detailed logs to: tree_comparison_chi_square_default.log
ğŸŒ² Beginning detailed recursive comparison...
ğŸŒ³ Comparing node at chi_square_default/root:
   Type: LEAF, Depth: 0, Samples: 8022
   âœ… Node metadata matches
   ğŸ“Š Sample counts: current=8022, baseline=8022, diff=0.000000
   âœ… Sample counts match
   ğŸ“ˆ Class counts: current=[4126.048898537895, 3895.526295616409], baseline=[4126.048898537895, 3895.526295616409]
   âœ… Class counts match
   ğŸ¯ Impurity: current=0.00000000, baseline=0.00000000, diff=0.00e+00
   âœ… Impurity matches
   ğŸƒ Leaf prediction: 0
   ğŸ“Š Probabilities: [0.5144, 0.4856]

âœ… Recursive tree comparison completed for chi_square_default
ğŸ“„ Detailed log saved to: tree_comparison_chi_square_default.log
PASSED

================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.13.7-final-0 _______________

Name                                      Stmts   Miss  Cover   Missing
-----------------------------------------------------------------------
theta_sketch_tree/__init__.py                25      4    84%   98-99, 144-145
theta_sketch_tree/classifier.py             103     33    68%   91-92, 148-149, 155, 178, 217-220, 238-245, 263-270, 294-295, 341-342, 348, 353, 357, 365-366
theta_sketch_tree/classifier_utils.py        48     30    38%   56-81, 99-114, 131-132, 160-175, 195-196, 213-214, 231-232, 261, 280
theta_sketch_tree/config_parser.py           42     32    24%   38, 64-86, 118, 135-163
theta_sketch_tree/criteria.py               116     32    72%   42-46, 56, 66, 69, 87, 99, 104, 132, 146, 165, 170-180, 206-219, 246
theta_sketch_tree/feature_importance.py      56      5    91%   59, 61, 63, 123, 145
theta_sketch_tree/interfaces.py              30      9    70%   281-287, 315-322
theta_sketch_tree/logging_utils.py           37      8    78%   48, 53, 57-58, 62, 84-86
theta_sketch_tree/model_evaluation.py       141    125    11%   40-42, 68-104, 113-121, 126-131, 144-179, 183-220, 224-239, 243-291, 328-337
theta_sketch_tree/model_persistence.py      119     94    21%   55-104, 126-177, 182-206, 211-244, 266-288, 293-297, 302-306, 311-317
theta_sketch_tree/pruning.py                119    119     0%   11-218
theta_sketch_tree/sketch_loader.py           71     61    14%   32, 48-55, 75-129, 191-255
theta_sketch_tree/split_finder.py            74     14    81%   106-108, 126, 198-201, 219, 228-230, 319-320
theta_sketch_tree/tree_builder.py            42     42     0%   8-164
theta_sketch_tree/tree_orchestrator.py       91     19    79%   89, 93, 97, 313-314, 381-394, 419-433, 480-484
theta_sketch_tree/tree_structure.py          32      7    78%   107-115, 126
theta_sketch_tree/tree_traverser.py          51     36    29%   33, 49-57, 75-83, 99-100, 116-117, 135-160, 177-184, 204-205, 224-225
theta_sketch_tree/validation_utils.py       102     38    63%   28, 35-37, 45, 51, 57, 62-63, 87, 90, 92, 97, 100, 110, 128, 131, 135, 137, 167-184, 206-215, 282, 306-307
-----------------------------------------------------------------------
TOTAL                                      1299    708    45%
Coverage HTML written to dir htmlcov
============================== 5 passed in 2.06s ===============================
